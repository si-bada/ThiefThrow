using System;
using System.Collections.Generic;

public static class LegendreGaussIntegral
{
    static Dictionary<int, float[]> xi_dic;
    static Dictionary<int, float[]> wi_dic;

    static LegendreGaussIntegral()
    {
        // Legendre-Gauss abscissae
        xi_dic = new Dictionary<int, float[]>();
        // Legendre-Gauss weights
        wi_dic = new Dictionary<int, float[]>();

        xi_dic.Add(24, new float[] {
           -0.0640568928626056260850430826247450385909f,
           0.0640568928626056260850430826247450385909f,
           -0.1911188674736163091586398207570696318404f,
           0.1911188674736163091586398207570696318404f,
           -0.3150426796961633743867932913198102407864f,
           0.3150426796961633743867932913198102407864f,
           -0.4337935076260451384870842319133497124524f,
           0.4337935076260451384870842319133497124524f,
           -0.5454214713888395356583756172183723700107f,
           0.5454214713888395356583756172183723700107f,
           -0.6480936519369755692524957869107476266696f,
           0.6480936519369755692524957869107476266696f,
           -0.7401241915785543642438281030999784255232f,
           0.7401241915785543642438281030999784255232f,
           -0.8200019859739029219539498726697452080761f,
           0.8200019859739029219539498726697452080761f,
           -0.8864155270044010342131543419821967550873f,
           0.8864155270044010342131543419821967550873f,
           -0.9382745520027327585236490017087214496548f,
           0.9382745520027327585236490017087214496548f,
           -0.9747285559713094981983919930081690617411f,
           0.9747285559713094981983919930081690617411f,
           -0.9951872199970213601799974097007368118745f,
           0.9951872199970213601799974097007368118745f
        });
        wi_dic.Add(24, new float[] {
           0.1279381953467521569740561652246953718517f,
           0.1279381953467521569740561652246953718517f,
           0.1258374563468282961213753825111836887264f,
           0.1258374563468282961213753825111836887264f,
           0.1216704729278033912044631534762624256070f,
           0.1216704729278033912044631534762624256070f,
           0.1155056680537256013533444839067835598622f,
           0.1155056680537256013533444839067835598622f,
           0.1074442701159656347825773424466062227946f,
           0.1074442701159656347825773424466062227946f,
           0.0976186521041138882698806644642471544279f,
           0.0976186521041138882698806644642471544279f,
           0.0861901615319532759171852029837426671850f,
           0.0861901615319532759171852029837426671850f,
           0.0733464814110803057340336152531165181193f,
           0.0733464814110803057340336152531165181193f,
           0.0592985849154367807463677585001085845412f,
           0.0592985849154367807463677585001085845412f,
           0.0442774388174198061686027482113382288593f,
           0.0442774388174198061686027482113382288593f,
           0.0285313886289336631813078159518782864491f,
           0.0285313886289336631813078159518782864491f,
           0.0123412297999871995468056670700372915759f,
           0.0123412297999871995468056670700372915759f
        });

        xi_dic.Add(12, new float[] {
             -0.1252334085114689f,
             0.1252334085114689f,
             -0.3678314989981802f,
             0.3678314989981802f,
             -0.5873179542866175f,
             0.5873179542866175f,
             -0.7699026741943047f,
             0.7699026741943047f,
             -0.9041172563704749f,
             0.9041172563704749f,
             -0.9815606342467192f,
             0.9815606342467192f,
        });
        wi_dic.Add(12, new float[] {
            0.2491470458134028f,
            0.2491470458134028f,
            0.2334925365383548f,
            0.2334925365383548f,
            0.2031674267230659f,
            0.2031674267230659f,
            0.1600783285433462f,
            0.1600783285433462f,
            0.1069393259953184f,
            0.1069393259953184f,
            0.0471753363865118f,
            0.0471753363865118f,
        });

        xi_dic.Add(6, new float[] {
             0.6612093864662645f,
             -0.6612093864662645f,
             -0.2386191860831969f,
             0.2386191860831969f,
             -0.9324695142031521f,
             0.9324695142031521f,
        });
        wi_dic.Add(6, new float[] {
            0.3607615730481386f,
            0.3607615730481386f,
            0.4679139345726910f,
            0.4679139345726910f,
            0.1713244923791704f,
            0.1713244923791704f,
        });

        xi_dic.Add(4, new float[] {
            -0.3399810435848563f,
            0.3399810435848563f,
            -0.8611363115940526f,
            0.8611363115940526f,
        });
        wi_dic.Add(4, new float[] {
            0.6521451548625461f,
            0.6521451548625461f,
            0.3478548451374538f,
            0.3478548451374538f,
        });
    }

    public static float Integrate(float t0, float t1, int precision, Func<float, float> function)
    {
        float z0 = (t1 - t0) / 2;
        float z1 = (t0 + t1) / 2;
        float sum = 0;
        float t;
        float[] xi = xi_dic[precision];
        float[] wi = wi_dic[precision];

        for (int i = 0; i < precision; i++)
        {
            t = z0 * xi[i] + z1;
            sum += wi[i] * function(t);
        }

        return z0 * sum;
    }
}
